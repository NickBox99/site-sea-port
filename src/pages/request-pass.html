<div class="request-pass">
    <div class="subtitle subtitle_margin-middle">ЗАЯВКА НА ПРОПУСК</div>
    <h1  class="request-pass__title">
        <span data-tabs="application-pass">Заявка на получение разового пешеходного пропуска</span>
        <span data-tabs="application-auto-pass" style="display: none;">Заявка на получение разового автомобильного пропуска</span>
    </h1>

    <div class="tabs request-pass__tabs">
        <div data-tabs-open="application-pass" class="tab active">Пешеходный пропуск</div>
        <div data-tabs-open="application-auto-pass" class="tab">Автомобильный пропуск</div>
        <div class="tabs__floatr"></div>
    </div>
    
    <div class="request-pass__documents request-pass-documents">
        
        <a href="#" class="file-block" target="_blank">
            <div class="file-block__file">
                @@include('../components/svg/file.html')
                <div class="file-block__type">xlsx</div>
            </div>
            
            <div class="file-block__content">
                <div class="file-block__title">Порядок оформления заявок</div>

                <div class="file-block__size">
                    36,12 kB
                    <div class="file-block__download">@@include('../components/svg/download.html')</div>
                </div>
            </div>
        </a>

        <a href="#" class="file-block" target="_blank">
            <div class="file-block__file">
                @@include('../components/svg/file.html')
                <div class="file-block__type">xlsx</div>
            </div>

            <div class="file-block__content">
                <div class="file-block__title">Шаблон заявки на пешеходный пропуск</div>

                <div class="file-block__size">
                    36,12 kB
                    <div class="file-block__download">@@include('../components/svg/download.html')</div>
                </div>
            </div>
        </a>
    </div>

    <form data-tabs="application-pass" id="applicationPass">
        <input type="hidden" name="form_id" value="applicationPass">
        <div class="filters-subtitle">Компания</div>
        <div class="filters-row request-pass__company">
            <input name="company_name" class="input input_secondary" placeholder="Полное наименование юр. лица*" type="text" role="presentation" autocomplete="off">
            <input name="company_fio_head" class="input input_secondary" placeholder="ФИО Руководителя*" type="text" role="presentation" autocomplete="off">
            <input name="company_phone_head" data-mask="+{7} (000) 000-00-00" class="input input_secondary" placeholder="Телефон руководителя*" type="text" role="presentation" autocomplete="off">
            <input name="company_inn" data-mask="000000000000" class="input input_secondary" placeholder="ИНН (000000000000)*" type="text" role="presentation" autocomplete="off">
        </div>
        
        <div class="filters-row">
            <div>
                <div class="request-pass__treaty">
                    <div class="filters-subtitle request-pass__visit-title">Приложить фото первой и последней страницы договора, если пропуск требуется для выполнения подрядных работ</div>
                    <div class="question-icon request-pass__treaty-icon">@@include('../components/svg/question.html')</div>
                </div>
                <div class="input-group">
                    <div class="input-group-icon input-group-icon_clip">@@include('../components/svg/clip.html')</div>
                    <label class="input input_secondary input_file input-file">
                        <input class="input-file__input" type="file" name="document"/>
                        <span class="input-file__name">Прикрепить файл</span>
                        <span class="input-file__cross hide">@@include('../components/svg/cross.html')</span>
                    </label>
                </div>
            </div>
        </div>
        
        <div class="filters-subtitle request-pass__visit-title">Цель посещения</div>
        <div class="filters-row request-pass__visit">
            <textarea name="visit_purpose" class="textarea textarea_secondary request-pass__purpose filters-col-3" placeholder="Текст" role="presentation" autocomplete="off"></textarea>
        </div>

        <div class="filters-subtitle request-pass__zones-title">Параметры пропуска</div>
        <div class="request-pass__zones">
            <label class="checkbox checkbox_secondary request-pass__zone">
                <input class="checkbox__input checked" type="checkbox">
                <span class="checkbox__text">Зона 1 (дорога, офисы в порту) </span>
            </label>

            <label class="checkbox checkbox_secondary request-pass__zone">
                <input name="pass_zone_2"  class="checkbox__input" type="checkbox">
                <span class="checkbox__text">Зона 2 (причалы) </span>
            </label>

            <label class="checkbox checkbox_secondary request-pass__zone">
                <input name="pass_zone_3" class="checkbox__input" type="checkbox">
                <span class="checkbox__text">Зона 3 (заграничные суда) </span>
            </label>
        </div>

        <div class="filters-row request-pass__zones-fields">
            <input name="pass_dates" class="datetime input input_secondary" placeholder=" Даты допуска*" data-flatpickr-multiple data-flatpickr-today>
            <div class="select select_secondary">
                <div class="select__value"></div>
                <input name="pass_order" type="hidden" class="select__input">
                <div class="select__wrapper">
                    <div class="select__items">
                        <div class="select__item btn btn_secondary active" data-value="">Пункт распоряжения правительства*</div>
                        <div class="select__item btn btn_secondary" data-value="1">ООО "Глобал Си Групп"</div>
                        <div class="select__item btn btn_secondary" data-value="2">ООО НАУТИЛУС</div>
                        <div class="select__item btn btn_secondary" data-value="3">ООО " Тураш"</div>
                        <div class="select__item btn btn_secondary" data-value="4">Fueltec Energy Oil and Gas</div>
                        <div class="select__item btn btn_secondary" data-value="5">ООО "РУССШИП"</div>
                        <div class="select__item btn btn_secondary" data-value="6">Русская Рыбопромышленная компания</div>
                        <div class="select__item btn btn_secondary" data-value="7">ООО ИГМАР</div>
                        <div class="select__item btn btn_secondary" data-value="8">ООО МКА "Морской Менеджер"</div>
                        <div class="select__item btn btn_secondary" data-value="1">ООО "Глобал Си Групп"</div>
                        <div class="select__item btn btn_secondary" data-value="2">ООО НАУТИЛУС</div>
                        <div class="select__item btn btn_secondary" data-value="3">ООО " Тураш"</div>
                        <div class="select__item btn btn_secondary" data-value="4">Fueltec Energy Oil and Gas</div>
                        <div class="select__item btn btn_secondary" data-value="5">ООО "РУССШИП"</div>
                        <div class="select__item btn btn_secondary" data-value="6">Русская Рыбопромышленная компания</div>
                        <div class="select__item btn btn_secondary" data-value="7">ООО ИГМАР</div>
                        <div class="select__item btn btn_secondary" data-value="8">ООО МКА "Морской Менеджер"</div>
                        <div class="select__item btn btn_secondary" data-value="1">ООО "Глобал Си Групп"</div>
                        <div class="select__item btn btn_secondary" data-value="2">ООО НАУТИЛУС</div>
                        <div class="select__item btn btn_secondary" data-value="3">ООО " Тураш"</div>
                        <div class="select__item btn btn_secondary" data-value="4">Fueltec Energy Oil and Gas</div>
                        <div class="select__item btn btn_secondary" data-value="5">ООО "РУССШИП"</div>
                        <div class="select__item btn btn_secondary" data-value="6">Русская Рыбопромышленная компания</div>
                        <div class="select__item btn btn_secondary" data-value="7">ООО ИГМАР</div>
                        <div class="select__item btn btn_secondary" data-value="8">ООО МКА "Морской Менеджер"</div>
                    </div>
                </div>
                <div class="select__daw">@@include('../components/svg/daw.html')</div>
            </div>

            <a href="#" class="file-block request-pass__pos">
                <div class="file-block__content">
                    <div class="file-block__title">Распоряжение Правительства РФ от 24 июня 2008 г. N 907-р (выписка)</div>

                    <div class="file-block__size">
                        36,12 kB
                        <div class="file-block__download">@@include('../components/svg/download.html')</div>
                    </div>
                </div>
            </a>
        </div>
    </form>

    <form data-tabs="application-auto-pass" id="applicationAutoPass" style="display: none;">
        <input type="hidden" name="form_id" value="applicationAutoPass">
        <div class="filters-subtitle">Компания</div>
        <div class="filters-row request-pass__company">
            <input name="company_name" class="input input_secondary" placeholder="Полное наименование юр. лица*" type="text" role="presentation" autocomplete="off">
            <input name="company_fio_head" class="input input_secondary" placeholder="ФИО Руководителя*" type="text" role="presentation" autocomplete="off">
            <input name="company_phone_head" data-mask="+{7} (000) 000-00-00" class="input input_secondary" placeholder="Телефон руководителя*" type="text" role="presentation" autocomplete="off">
            <input name="company_inn" class="input input_secondary" placeholder="ИНН (000000000000)*" type="text" role="presentation" autocomplete="off">
        </div>

        <div class="filters-row">
            <div>
                <div class="request-pass__treaty">
                    <div class="filters-subtitle request-pass__visit-title">Приложить фото первой и последней страницы договора, если пропуск требуется для выполнения подрядных работ</div>
                    <div class="question-icon request-pass__treaty-icon">@@include('../components/svg/question.html')</div>
                </div>
                <div class="input-group">
                    <div class="input-group-icon input-group-icon_clip">@@include('../components/svg/clip.html')</div>
                    <label class="input input_secondary input_file input-file">
                        <input class="input-file__input" type="file" name="document"/>
                        <span class="input-file__name">Прикрепить файл</span>
                        <span class="input-file__cross hide">@@include('../components/svg/cross.html')</span>
                    </label>
                </div>
            </div>
        </div>
        
        <div class="filters-subtitle request-pass__visit-title">Цель посещения</div>
        <div class="filters-row request-pass__visit">
            <textarea name="visit_purpose" class="textarea textarea_secondary request-pass__purpose filters-col-3" placeholder="Текст" role="presentation" autocomplete="off"></textarea>
        </div>

        <div class="filters-subtitle request-pass__zones-title">Параметры пропуска</div>
        <div class="request-pass__zones">
            <label class="checkbox checkbox_secondary request-pass__zone">
                <input class="checkbox__input checked" type="checkbox">
                <span class="checkbox__text">Зона 1 (дорога, офисы в порту) </span>
            </label>

            <label class="checkbox checkbox_secondary request-pass__zone">
                <input name="pass_zone_2"  class="checkbox__input" type="checkbox">
                <span class="checkbox__text">Зона 2 (причалы) </span>
            </label>
        </div>

        <div class="filters-row request-pass__zones-fields">
            <input name="pass_dates" class="datetime input input_secondary" placeholder=" Даты допуска*" data-flatpickr-multiple data-flatpickr-today>
            <div class="select select_secondary">
                <div class="select__value"></div>
                <input name="pass_order" type="hidden" class="select__input">
                <div class="select__wrapper">
                    <div class="select__items">
                        <div class="select__item btn btn_secondary active" data-value="">Пункт распоряжения правительства*</div>
                        <div class="select__item btn btn_secondary" data-value="1">ООО "Глобал Си Групп"</div>
                        <div class="select__item btn btn_secondary" data-value="2">ООО НАУТИЛУС</div>
                        <div class="select__item btn btn_secondary" data-value="3">ООО " Тураш"</div>
                        <div class="select__item btn btn_secondary" data-value="4">Fueltec Energy Oil and Gas</div>
                        <div class="select__item btn btn_secondary" data-value="5">ООО "РУССШИП"</div>
                        <div class="select__item btn btn_secondary" data-value="6">Русская Рыбопромышленная компания</div>
                        <div class="select__item btn btn_secondary" data-value="7">ООО ИГМАР</div>
                        <div class="select__item btn btn_secondary" data-value="8">ООО МКА "Морской Менеджер"</div>
                    </div>
                </div>
                <div class="select__daw">@@include('../components/svg/daw.html')</div>
            </div>

            <a href="#" class="file-block request-pass__pos">
                <div class="file-block__content">
                    <div class="file-block__title">Распоряжение Правительства РФ от 24 июня 2008 г. N 907-р (выписка)</div>

                    <div class="file-block__size">
                        36,12 kB
                        <div class="file-block__download">@@include('../components/svg/download.html')</div>
                    </div>
                </div>
            </a>
        </div>
    </form>

    <div data-tabs="application-pass" class="passes request-pass__passes"></div>

    <div data-tabs="application-auto-pass" class="passes request-pass__passes" style="display: none;"></div>
    
    <div class="request-pass-signature">
        <h3 class="request-pass-signature__title">Электронно-цифровая подпись</h3>
        
        <form id="signature-form">
            <div class="request-pass-signature__description">
                Если ФИО в электронной подписи не совпадает с ФИО руководителя 
                предприятия, необходимо предоставить доверенность на право подписи от 
                имени руководителя предприятия <a href="#" target="_blank">(скачать образец)</a>
                <br>
                <br>
                Внимание! Для использования ЭЦП необходимо загрузить и установить:<br>
                - плагин КриптоПро ЭЦП Browser plug-in<br>
                - криптопровайдер СКЗИ КриптоПро CSP
            </div>

            <label class="checkbox checkbox_third">
                <input name="isAgreeProcessing" class="checkbox__input" type="checkbox">
                <span class="checkbox__text">Согласен на обработку персональных данных</span>
            </label>

            <label class="checkbox checkbox_third">
                <input name="isAgreeRules" class="checkbox__input" type="checkbox">
                <span class="checkbox__text">С правилами нахождения на режимной территории ознакомлен</span>
            </label>

            <button class="btn btn_primary request-pass-signature__btn" type="submit">Отправить без ЭЦП</button>
        </form>
    </div>
</div>

<div id="request-speeches-sent" class="popup">
    <div class="popup__wrapper">
        <div class="popup__header">
            <div class="popup__title">Ваша заявка отправлена</div>
            <div class="popup__cross" data-popup-close>@@include('../components/svg/cross.html')</div>
        </div>

        <div class="popup__content">
            Если у Вас нет постоянного автомобильного пропуска, для нахождения на территории порта Вам необходимо отправить заявку на предоставление РАЗОВОГО
            <a href="#" class="popup__link" target="_blank">автомобильного&nbsp;пропуска</a>
        </div>

        <button class="popup__btn btn btn_primary root-white">Вернуться на сайт</button>
    </div>
</div>

<script id="application-passes" type="text/template">
    <h3 class="request-pass-block__title">Пропуск # ПП_И000766</h3>

    <div class="filters-subtitle">Личные данные</div>
    <div class="filters-row request-pass-block__filters-row">
        <input name="personal_surname" class="input" placeholder="Фамилия*" type="text" role="presentation" autocomplete="off">
        <input name="personal_name" class="input" placeholder="Имя*" type="text"  role="presentation" autocomplete="off">
        <input name="personal_patronymic" class="input" placeholder="Отчество*" type="text" role="presentation" autocomplete="off">
        <input name="personal_birthday" class="datetime input" placeholder=" Дата рождения*" data-placeholder-focus>

        <input name="personal_birth_place" class="input" placeholder="Место рождения*" type="text" role="presentation" autocomplete="off">
        <input name="personal_position" class="input" placeholder=" Должность получателя*" type="text" role="presentation" autocomplete="off">
    </div>

    <div class="filters-subtitle">Паспортные данные</div>
    <div class="filters-row request-pass-block__filters-row">
        <input name="passport_series" data-mask="0000" class="input" placeholder="Номер*" type="text" role="presentation" autocomplete="off">
        <input name="passport_number" data-mask="000000" class="input" placeholder="Серия*" type="text" role="presentation" autocomplete="off">
        <input name="passport_date" class="datetime input" placeholder=" Дата выдачи*" data-placeholder-focus>
        <input name="passport_place" class="input filters-col-3" placeholder="Кем выдан*" type="text" role="presentation" autocomplete="off">
    </div>

    <div class="filters-subtitle">Контактные данные</div>
    <div class="filters-row request-pass-block__filters-row">
        <input name="contact_registration_address" class="input filters-col-3" placeholder="Адрес регистрации*" type="text" role="presentation" autocomplete="off">
        <input name="contact_factual_address" class="input filters-col-3" placeholder="Фактический адрес*" type="text" role="presentation" autocomplete="off">
        <input name="contact_phone" data-mask="+{7} (000) 000-00-00" class="input" placeholder="Контактный телефон*" type="text" role="presentation" autocomplete="off">
        <input name="contact_email" class="input" placeholder="Электронная почта*" type="text" role="presentation" autocomplete="off">
    </div>

    <div class="request-pass-block__footer">
        <button class="btn btn_primary request-pass-block__btn" onclick="addPass('application-passes', applicationPasses, this)" type="button">Добавить пропуск</button>
        <button class="btn btn_third request-pass-block__btn request-pass-block__btn_remove" style="display: none;" onclick="removePass.call(this)" type="button">Удалить пропуск</button>
    </div>
</script>

<script id="application-auto-passes" type="text/template">
    <h3 class="request-pass-block__title">Пропуск # ПП_И000766</h3>

    <div class="filters-subtitle">Личные данные</div>
    <div class="filters-row request-pass-block__filters-row">
        <input name="personal_surname" class="input" placeholder="Фамилия*" type="text" role="presentation" autocomplete="off">
        <input name="personal_name" class="input" placeholder="Имя*" type="text"  role="presentation" autocomplete="off">
        <input name="personal_patronymic" class="input" placeholder="Отчество*" type="text" role="presentation" autocomplete="off">
        <input name="personal_birthday" class="datetime input" placeholder=" Дата рождения*" data-placeholder-focus>

        <input name="personal_birth_place" class="input" placeholder="Место рождения*" type="text" role="presentation" autocomplete="off">
        <input name="personal_position" class="input" placeholder=" Должность получателя*" type="text" role="presentation" autocomplete="off">
    </div>

    <div class="filters-subtitle">Паспортные данные</div>
    <div class="filters-row request-pass-block__filters-row">
        <input name="passport_series" data-mask="0000" class="input" placeholder="Номер*" type="text" role="presentation" autocomplete="off">
        <input name="passport_number" data-mask="000000" class="input" placeholder="Серия*" type="text" role="presentation" autocomplete="off">
        <input name="passport_date" class="datetime input" placeholder=" Дата выдачи*" data-placeholder-focus>
        <input name="passport_place" class="input filters-col-3" placeholder="Кем выдан*" type="text" role="presentation" autocomplete="off">
    </div>

    <div class="filters-subtitle">Контактные данные</div>
    <div class="filters-row request-pass-block__filters-row">
        <input name="contact_registration_address" class="input filters-col-3" placeholder="Адрес регистрации*" type="text" role="presentation" autocomplete="off">
        <input name="contact_factual_address" class="input filters-col-3" placeholder="Фактический адрес*" type="text" role="presentation" autocomplete="off">
        <input name="contact_phone" data-mask="+{7} (000) 000-00-00" class="input" placeholder="Контактный телефон*" type="text" role="presentation" autocomplete="off">
        <input name="contact_email" class="input" placeholder="Электронная почта*" type="text" role="presentation" autocomplete="off">
    </div>

    <div class="filters-subtitle">Данные автомобиля</div>
    <div class="filters-row request-pass-block__filters-row">
        <div class="select">
            <div class="select__value"></div>
            <input name="car_type" type="hidden" class="select__input">
            <div class="select__wrapper">
                <div class="select__items">
                    <div class="select__item btn btn_secondary active" data-value="">Легковой</div>
                    <div class="select__item btn btn_secondary" data-value="1">ООО "Глобал Си Групп"</div>
                    <div class="select__item btn btn_secondary" data-value="2">ООО НАУТИЛУС</div>
                    <div class="select__item btn btn_secondary" data-value="3">ООО " Тураш"</div>
                    <div class="select__item btn btn_secondary" data-value="4">Fueltec Energy Oil and Gas</div>
                    <div class="select__item btn btn_secondary" data-value="5">ООО "РУССШИП"</div>
                    <div class="select__item btn btn_secondary" data-value="6">Русская Рыбопромышленная компания</div>
                    <div class="select__item btn btn_secondary" data-value="7">ООО ИГМАР</div>
                    <div class="select__item btn btn_secondary" data-value="8">ООО МКА "Морской Менеджер"</div>
                </div>
            </div>
            <div class="select__daw">@@include('../components/svg/daw.html')</div>
        </div>
        <input name="car_brand" class="input" placeholder="Марка*" type="text" role="presentation" autocomplete="off">
        <input name="car_model" class="input" placeholder="Модель*" type="text" role="presentation" autocomplete="off">
        <input name="car_number" class="input" placeholder="Гос. номер*" type="text" role="presentation" autocomplete="off">
        <input name="car_color" class="input" placeholder="Цвет*" type="text" role="presentation" autocomplete="off">
    </div>

    <div class="request-pass-block__footer">
        <button class="btn btn_primary request-pass-block__btn" onclick="addPass('application-auto-passes', applicationAutoPasses, this)" type="button">Добавить пропуск</button>
        <button class="btn btn_third request-pass-block__btn request-pass-block__btn_remove" style="display: none;" onclick="removePass.call(this)" type="button">Удалить пропуск</button>
    </div>
</script>

<script>
    const applicationPass = document.querySelector('#applicationPass');
    const applicationPasses = document.querySelector('.passes[data-tabs="application-pass"]');
    const applicationAutoPass = document.querySelector('#applicationAutoPass');
    const applicationAutoPasses = document.querySelector('.passes[data-tabs="application-auto-pass"]');
    let uniqueId = 0;
    
    function getPassBlock(el) {
        return el.closest('.request-pass-block');
    }
    
    function initRemoveButtons(wrapper) {
        const children = wrapper.children;
        const display = children.length > 1? 'block' : 'none';
        [...children].forEach(el => el.querySelector('.request-pass-block__btn_remove').style.display = display);
    }
    
    function addPass(templateId, wrapper, btn) {
        const form = document.createElement('form');
        form.classList.add('request-pass-block');
        form.innerHTML = document.querySelector(`#${templateId}`).innerHTML;
        const formId = `pass-${uniqueId++}`;
        form.setAttribute('id', formId);

        if (btn) {
            const pass = getPassBlock(btn);
            wrapper.insertBefore(form, pass.nextSibling);

            initRemoveButtons(wrapper);
        } else {
            wrapper.append(form);
        }

        initSelects(form);
        initDates(form);
        initMasks(form);
    }
    
    function removePass() {
        const pass = getPassBlock(this);
        const parent = pass.parentNode;
        
        if(parent.children.length < 2) {
            return;
        }
        
        pass.remove();
        initRemoveButtons(parent);
    }
    
    document.addEventListener("DOMContentLoaded", () => {
        addPass('application-passes', applicationPasses);
        addPass('application-auto-passes', applicationAutoPasses);
        
        const applicationSentPopup = new Popup('#request-speeches-sent');
        
        const signatureForm = document.querySelector('#signature-form');
        signatureForm.addEventListener('submit', (event) => {
            event.preventDefault();
            
            const isApplicationPass = !applicationPass.style.display;
            
            const isValidSignatureForm = Boolean(formValidate(signatureForm, {
                isAgreeProcessing: {
                    type: 'checkbox',
                    validate: 'required'
                },
                isAgreeRules: {
                    type: 'checkbox',
                    validate: 'required'
                }
            }));
            
            const defaultMainOptions = {
                company_name: {
                    type: 'input',
                    validate: 'required'
                },
                company_fio_head: {
                    type: 'input',
                    validate: 'abs|required'
                },
                company_phone_head: {
                    type: 'input',
                    validate: 'length:18'
                },
                company_inn: {
                    type: 'input',
                    validate: 'min-length:10|max-length:12'
                },
                visit_purpose: {
                    type: 'input'
                },
                pass_zone_2: {
                    type: 'checkbox'
                },
                pass_dates: {
                    type: 'date',
                    validate: 'required'
                },
                pass_order: {
                    type: 'select',
                    validate: 'required'
                }
            }
            const mainForm = isApplicationPass ? 
                formValidate(applicationPass, {
                    ...defaultMainOptions,
                    pass_zone_3: {
                        type: 'checkbox'
                    }
                }) :
                formValidate(applicationAutoPass, defaultMainOptions);
            
            const defaultPassOptions = {
                personal_surname: {
                    type: 'input',
                    validate: 'required|abs'
                },
                personal_name: {
                    type: 'input',
                    validate: 'required|abs'
                },
                personal_patronymic: {
                    type: 'input',
                    validate: 'required|abs'
                },
                personal_birthday: {
                    type: 'date',
                    validate: 'required'
                },
                personal_birth_place: {
                    type: 'input',
                    validate: 'required'
                },
                personal_position: {
                    type: 'input',
                    validate: 'required|abs'
                },
                passport_series: {
                    type: 'input',
                    validate: 'length:4'
                },
                passport_number: {
                    type: 'input',
                    validate: 'length:6'
                },
                passport_date: {
                    type: 'date',
                    validate: 'required'
                },
                passport_place: {
                    type: 'input',
                    validate: 'required'
                },
                contact_email: {
                    type: 'input',
                    validate: 'email'
                },
                contact_phone: {
                    type: 'input',
                    validate: 'length:18'
                },
                contact_registration_address: {
                    type: 'input',
                    validate: 'required'
                },
                contact_factual_address: {
                    type: 'input',
                    validate: 'required'
                }
            }
            const passesValidatorOptions = isApplicationPass ? defaultPassOptions : 
                { 
                    ...defaultPassOptions,
                    car_type: {
                        type: 'select',
                        validate: 'required'
                    },
                    car_brand: {
                        type: 'input',
                        validate: 'required'
                    },
                    car_model: {
                        type: 'input',
                        validate: 'required'
                    },
                    car_number: {
                        type: 'input',
                        validate: 'required'
                    },
                    car_color: {
                        type: 'input',
                        validate: 'required'
                    }
                };
            const passes = [...(isApplicationPass ? applicationPasses : applicationAutoPasses).children].map(pass => formValidate(pass, passesValidatorOptions, false));

            if (isValidSignatureForm && mainForm && !passes.filter(pass => !pass).length) {
                mainForm.append('passes_json', JSON.stringify(passes));

                fetch(`${window.config.host}/ajax/form.php`, {
                    method: 'POST',
                    body: mainForm
                }).then(({ status }) => {
                    if (status === 200) {
                        applicationSentPopup.show();
                        clearForm(signatureForm);
                        clearForm(isApplicationPass ? applicationPass : applicationAutoPass);
                        [...(isApplicationPass ? applicationPasses : applicationAutoPasses).children].forEach(pass => clearForm(pass));
                    }
                });
            }
        });
    })
</script>