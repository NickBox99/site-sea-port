<div class="request-speeches">
    <div class="subtitle subtitle_margin-middle">ЗАЯВКА НА ДОСМОТР</div>
    <h1 class="request-speeches__title">Заявка на выставление контейнера</h1>
    <div class="request-speeches__description description description_middle">
        Начальнику контейнерного терминала.<br>
        Прошу Вас на основании требования таможни
        выставить для досмотра следующие контейнеры:</div>
    
    <form id="applicationForInspection" autocomplete="off">
        <input type="hidden" name="form_id" value="applicationForInspection">
        <div class="filters-subtitle">Контейнер</div>
        <div class="filters-row">
            <input name="container_number_ktk" data-validate="required" class="input input_secondary" placeholder="Номер КТК*" type="text">
            <div class="select select_secondary">
                <div class="select__value"></div>
                <input name="container_type_of_packaging" data-validate="required" type="hidden" class="select__input">
                <div class="select__wrapper">
                    <div class="select__item btn btn_secondary active" data-value="">Тип упаковки*</div>
                    <div class="select__item btn btn_secondary" data-value="1">ООО "Глобал Си Групп"</div>
                    <div class="select__item btn btn_secondary" data-value="2">ООО НАУТИЛУС</div>
                    <div class="select__item btn btn_secondary" data-value="3">ООО " Тураш"</div>
                    <div class="select__item btn btn_secondary" data-value="4">Fueltec Energy Oil and Gas</div>
                    <div class="select__item btn btn_secondary" data-value="5">ООО "РУССШИП"</div>
                    <div class="select__item btn btn_secondary" data-value="6">Русская Рыбопромышленная компания</div>
                    <div class="select__item btn btn_secondary" data-value="7">ООО ИГМАР</div>
                    <div class="select__item btn btn_secondary" data-value="8">ООО МКА "Морской Менеджер"</div>
                </div>
                <div class="select__daw">@@include('../components/svg/daw.html')</div>
            </div>
            <div class="select select_secondary">
                <div class="select__value"></div>
                <input name="container_type_of_inspection" data-validate="required" type="hidden" class="select__input">
                <div class="select__wrapper">
                    <div class="select__item btn btn_secondary active" data-value="">Вид досмотра*</div>
                    <div class="select__item btn btn_secondary" data-value="1">ООО "Глобал Си Групп"</div>
                    <div class="select__item btn btn_secondary" data-value="2">ООО НАУТИЛУС</div>
                    <div class="select__item btn btn_secondary" data-value="3">ООО " Тураш"</div>
                    <div class="select__item btn btn_secondary" data-value="4">Fueltec Energy Oil and Gas</div>
                    <div class="select__item btn btn_secondary" data-value="5">ООО "РУССШИП"</div>
                    <div class="select__item btn btn_secondary" data-value="6">Русская Рыбопромышленная компания</div>
                    <div class="select__item btn btn_secondary" data-value="7">ООО ИГМАР</div>
                    <div class="select__item btn btn_secondary" data-value="8">ООО МКА "Морской Менеджер"</div>
                </div>
                <div class="select__daw">@@include('../components/svg/daw.html')</div>
            </div>

            <input name="container_date_ktk" data-validate="required" class="datetime input input_secondary" placeholder=" Дата подачи КТК*" data-placeholder-focus>
            <textarea name="container_comment" class="textarea textarea_secondary filters-col-2 request-speeches__comment" placeholder="Комментарий" type="text"></textarea>
        </div>

        <div class="filters-subtitle">Представитель на досмотровой площадке</div>
        <div class="filters-row">
            <input name="member_surname" data-validate="required" class="input input_secondary" placeholder="Фамилия*" type="text" role="presentation" autocomplete="off">
            <input name="member_name" data-validate="required" class="input input_secondary" placeholder="Имя*" type="text" role="presentation" autocomplete="off">
            <input name="member_patronymic" data-validate="required" class="input input_secondary" placeholder="Отчество*" type="text" role="presentation" autocomplete="off">
        </div>

        <div class="filters-subtitle">Контактные данные</div>
        <div class="filters-row">
            <input name="contact_phone" data-mask="+{7} (000) 000-00-00" class="input input_secondary" placeholder="Контактный телефон*" type="text" role="presentation" autocomplete="off">
            <input name="contact_email" class="input input_secondary" placeholder="Электронная почта*" type="text" role="presentation" autocomplete="off">
            <input name="contact_proxy_number" data-validate="required" class="input input_secondary" placeholder="№ доверенности*" type="text">
            <input name="contact_proxy_date" data-validate="required" class="datetime input input_secondary" placeholder=" Дата выдачи*" data-placeholder-focus>
        </div>

        <div class="filters-row request-speeches__footer">
            <div class="input-group">
                <div class="input-group-icon input-group-icon_clip">@@include('../components/svg/clip.html')</div>
                <label class="input input_secondary input_file input-file">
                    <input class="input-file__input" type="file" name="document"/>
                    <span class="input-file__name">Прикрепить файл</span>
                    <span class="input-file__cross hide">@@include('../components/svg/cross.html')</span>
                </label>
            </div>

            <div>
                <label class="checkbox checkbox_third">
                    <input name="isAgreeProcessing" data-validate="required" class="checkbox__input" type="checkbox">
                    <span class="checkbox__text">Согласен на обработку персональных данных</span>
                </label>
                <label class="checkbox checkbox_third">
                    <input name="isAgreeRules" class="checkbox__input" type="checkbox">
                    <span class="checkbox__text">С правилами нахождения на режимной территории ознакомлен</span>
                </label>
            </div>

            <button class="btn btn_primary btn_w-100 btn_large request-speeches__btn" type="submit">Отправить</button>
        </div>
    </form>
</div>

<div id="request-speeches-sent" class="popup">
    <div class="popup__wrapper">
        <div class="popup__header">
            <div class="popup__title">Ваша заявка отправлена</div>
            <div class="popup__cross" data-popup-close>@@include('../components/svg/cross.html')</div>
        </div>

        <div class="popup__content">
            Если у Вас нет постоянного автомобильного пропуска, для нахождения на территории порта Вам необходимо отправить заявку на предоставление РАЗОВОГО
            <a href="#" class="popup__link" target="_blank">автомобильного&nbsp;пропуска</a>
        </div>

        <button class="popup__btn btn btn_primary root-white" data-popup-close>Вернуться на сайт</button>
    </div>
</div>

<script>
    document.addEventListener("DOMContentLoaded", () => {
        const applicationSentPopup = new Popup('#request-speeches-sent');
        const form = document.querySelector('#applicationForInspection');
        
        const validateOptions = initValidateOptions({
            container_number_ktk: {
                type: 'input'
            },
            container_comment: {
                type: 'input'
            },
            container_date_ktk: {
                type: 'date'
            },
            container_type_of_packaging: {
                type: 'select'
            },
            container_type_of_inspection: {
                type: 'select'
            },
            member_surname: {
                type: 'input',
                validate: 'abs'
            },
            member_name: {
                type: 'input',
                validate: 'abs'
            },
            member_patronymic: {
                type: 'input',
                validate: 'abs'
            },
            contact_phone: {
                type: 'input',
                validate: 'length:18'
            },
            contact_email: {
                type: 'input',
                validate: 'email'
            },
            contact_proxy_number: {
                type: 'input'
            },
            contact_proxy_date: {
                type: 'date'
            },
            document: {
                type: 'file'
            },
            isAgreeProcessing: {
                type: 'checkbox'
            },
            isAgreeRules: {
                type: 'checkbox'
            }
        });
        
        form.addEventListener('submit', (event) => {
            event.preventDefault();
            
            const formData = formValidate(form, validateOptions);
            
            if (formData) {
                fetch(`${window.config.host}/ajax/form.php`, {
                    method: 'POST',
                    body: formData
                }).then(({ status }) => {
                    if (status === 200) {
                        applicationSentPopup.show();
                        clearForm(form);
                    }
                });
            }
        });
    });
</script>