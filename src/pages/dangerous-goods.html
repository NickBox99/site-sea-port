<div class="dangerous-goods">
    <div class="dangerous-goods__breadcrumbs breadcrumbs">
        <a href="#" class="dangerous-goods__breadcrumb breadcrumbs__item">Пункт 1</a> /
        <a href="#" class="dangerous-goods__breadcrumb breadcrumbs__item">Пункт 2</a> /
        <span class="dangerous-goods__breadcrumb  breadcrumbs__item_current">Пункт 3</span>
    </div>
    
    <h1 class="title dangerous-goods__title">Перевалка опасных грузов</h1>
    
    <div class="tabs dangerous-goods__tabs">
        <div data-tabs-open="import-permit" class="tab active">Разрешение на завоз</div>
        <div data-tabs-open="documents" class="tab">Документы</div>
        <div data-tabs-open="fastening-schemes" class="tab">Схемы крепления</div>
        <div class="tabs__floatr"></div>
    </div>
    
    <div data-tabs="import-permit">
        <h2 class="dangerous-goods__caption">Разрешение на завоз опасного груза</h2>

        <form id="permission-form" class="dangerous-goods__form">
            <input data-mask="0000000" name="ooh" type="text" class="input input_secondary" placeholder="Ввести номер ООН" role="presentation" autocomplete="off">
            <div class="select select_secondary">
                <div class="select__value"></div>
                <input name="group" type="hidden" class="select__input">
                <div class="select__wrapper">
                    <div class="select__item btn btn_secondary" data-value="">Выберите группу упаковки</div>
                    <div class="select__item btn btn_secondary" data-value="1">Дате публикации</div>
                    <div class="select__item btn btn_secondary" data-value="2">Дате окончания приема предложений</div>
                    <div class="select__item btn btn_secondary" data-value="3">По убыванию НМЦ</div>
                    <div class="select__item btn btn_secondary" data-value="4">По возрастанию НМЦ</div>
                </div>
                <div class="select__daw">@@include('../components/svg/daw.html')</div>
            </div>
            <button class="btn btn_primary btn_w-100 btn_large" type="submit">Добавить</button>
        </form>
        
        <div class="dangerous-goods__table" style="display: none">
            <div class="table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th>№</th>
                            <th>НОМЕР ООН</th>
                            <th>ГРУППА УПАКОВКИ</th>
                        </tr>
                    </thead>
                    <tbody id="table-permission-body"></tbody>
                </table>
            </div>
            
            <button class="btn btn_primary dangerous-goods__table-btn" type="submit" onclick="requestPermission()">Запросить разрешение</button>
        </div>
        
        <div class="dangerous-goods__permissions" style="display: none">
            <div class="dangerous-goods-permission">
                <div class="dangerous-goods-permission__content">
                    <div class="dangerous-goods-permission__col">
                        <div class="subtitle">Название</div>
                        <h3 class="dangerous-goods-permission__title">Ксантогенаты xanthates</h3>
                        <div class="dangerous-goods-permission__description">Желтый гигроскопический порошок с неприятным запахом. при контакте с влагой выделяет такие жирные кислоты</div>
                        <div class="subtitle">Прием в порт</div>
                        <div class="dangerous-goods-permission__depiction">Желтый гигроскопический порошок с неприятным запахом. при контакте с влагой выделяет такие жирные кислоты</div>
                    </div>
                    <div class="dangerous-goods-permission__col">
                        <div class="subtitle">Номер ООН</div>
                        <div class="dangerous-goods-permission__value">3342</div>
                        
                        <div class="subtitle">Группа упаковки</div>
                        <div class="dangerous-goods-permission__value">I - вещества с высокой степенью опасности</div>
                        
                        <div class="subtitle">Класс или подкласс</div>
                        <div class="dangerous-goods-permission__value">4.2</div>
                        
                        <div class="dangerous-goods-permission__additional-wrapper">
                            <div class="dangerous-goods-permission__additional">
                                <div class="subtitle">Доп виды опасности</div>
                                Информация отсутствует
                            </div>
                            <div class="dangerous-goods-permission__additional">
                                <div class="subtitle">Запрещен прием по&nbsp;ЖД</div>
                                Информация отсутствует
                            </div>
                            <div class="dangerous-goods-permission__additional">
                                <div class="subtitle">Инструкции по&nbsp;цистернам</div>
                                ТЗ
                            </div>
                        </div>
                    </div>
                </div>
                <div class="dangerous-goods-permission__status dangerous-goods-permission__status_success">Согласован</div>
                <div class="dangerous-goods-permission__depiction">*Для дополнительного согласования необходимо обратиться к вашему экспедитору</div>
            </div>
<!--            -->
<!--            <div class="dangerous-goods-permission failure">-->
<!--                <div class="dangerous-goods-permission__content">-->
<!--                    <div class="dangerous-goods-permission__col">-->
<!--                        <div class="subtitle">Название</div>-->
<!--                        <h3 class="dangerous-goods-permission__title">Ксантогенаты xanthates</h3>-->
<!--                        <div class="dangerous-goods-permission__description">Желтый гигроскопический порошок с неприятным запахом. при контакте с влагой выделяет такие жирные кислоты</div>-->
<!--                        <div class="subtitle">Прием в порт</div>-->
<!--                        <div class="dangerous-goods-permission__depiction">Желтый гигроскопический порошок с неприятным запахом. при контакте с влагой выделяет такие жирные кислоты</div>-->
<!--                    </div>-->
<!--                    <div class="dangerous-goods-permission__col">-->
<!--                        <div class="subtitle">Номер ООН</div>-->
<!--                        <div class="dangerous-goods-permission__value">3342</div>-->
<!--                        -->
<!--                        <div class="subtitle">Группа упаковки</div>-->
<!--                        <div class="dangerous-goods-permission__value">I - вещества с высокой степенью опасности</div>-->
<!--                        -->
<!--                        <div class="subtitle">Класс или подкласс</div>-->
<!--                        <div class="dangerous-goods-permission__value">4.2</div>-->
<!--                        -->
<!--                        <div class="dangerous-goods-permission__additional-wrapper">-->
<!--                            <div class="dangerous-goods-permission__additional">-->
<!--                                <div class="subtitle">Доп виды опасности</div>-->
<!--                                Информация отсутствует-->
<!--                            </div>-->
<!--                            <div class="dangerous-goods-permission__additional">-->
<!--                                <div class="subtitle">Запрещен прием по&nbsp;ЖД</div>-->
<!--                                Информация отсутствует-->
<!--                            </div>-->
<!--                            <div class="dangerous-goods-permission__additional">-->
<!--                                <div class="subtitle">Инструкции по&nbsp;цистернам</div>-->
<!--                                ТЗ-->
<!--                            </div>-->
<!--                        </div>-->
<!--                    </div>-->
<!--                </div>-->
<!--                <div class="dangerous-goods-permission__status dangerous-goods-permission__status_failure">Отклонен</div>-->
<!--            </div>-->
<!--            -->
<!--            <div class="dangerous-goods-permission">-->
<!--                <div class="dangerous-goods-permission__content">-->
<!--                    <div class="dangerous-goods-permission__col">-->
<!--                        <div class="subtitle">Название</div>-->
<!--                        <h3 class="dangerous-goods-permission__title">Ксантогенаты xanthates</h3>-->
<!--                        <div class="dangerous-goods-permission__description">Желтый гигроскопический порошок с неприятным запахом. при контакте с влагой выделяет такие жирные кислоты</div>-->
<!--                        <div class="subtitle">Прием в порт</div>-->
<!--                        <div class="dangerous-goods-permission__depiction">Желтый гигроскопический порошок с неприятным запахом. при контакте с влагой выделяет такие жирные кислоты</div>-->
<!--                    </div>-->
<!--                    <div class="dangerous-goods-permission__col">-->
<!--                        <div class="subtitle">Номер ООН</div>-->
<!--                        <div class="dangerous-goods-permission__value">3342</div>-->
<!--                        -->
<!--                        <div class="subtitle">Группа упаковки</div>-->
<!--                        <div class="dangerous-goods-permission__value">I - вещества с высокой степенью опасности</div>-->
<!--                        -->
<!--                        <div class="subtitle">Класс или подкласс</div>-->
<!--                        <div class="dangerous-goods-permission__value">4.2</div>-->
<!--                        -->
<!--                        <div class="dangerous-goods-permission__additional-wrapper">-->
<!--                            <div class="dangerous-goods-permission__additional">-->
<!--                                <div class="subtitle">Доп виды опасности</div>-->
<!--                                Информация отсутствует-->
<!--                            </div>-->
<!--                            <div class="dangerous-goods-permission__additional">-->
<!--                                <div class="subtitle">Запрещен прием по&nbsp;ЖД</div>-->
<!--                                Информация отсутствует-->
<!--                            </div>-->
<!--                            <div class="dangerous-goods-permission__additional">-->
<!--                                <div class="subtitle">Инструкции по&nbsp;цистернам</div>-->
<!--                                ТЗ-->
<!--                            </div>-->
<!--                        </div>-->
<!--                    </div>-->
<!--                </div>-->
<!--                <div class="dangerous-goods-permission__status dangerous-goods-permission__status_expectation">Требуется согласование</div>-->
<!--                <div class="dangerous-goods-permission__depiction">*Для дополнительного согласования необходимо обратиться к вашему экспедитору</div>-->
<!--            </div>-->
        </div>
    </div>
    
    <div data-tabs="documents" class="file-list" style="display: none;">
        <a href="#" class="file-block file-list__file" target="_blank">
            <div class="file-block__file file-list__type">
                @@include('../components/svg/file.html')
                <div class="file-block__type">pdf</div>
            </div>

            <div class="file-block__content">
                <div class="file-block__title file-list__title">Заголовок (H4) Название документа. Размер может быть любой количество символ и строк не ограничено. Название документа. Размер может быть любой количество символ и строк не ограничено.</div>

                <div class="file-block__size">
                    32,5 kB
                    <div class="file-block__download">@@include('../components/svg/download.html')</div>
                </div>
            </div>
        </a>
        
        <a href="#" class="file-block file-list__file" target="_blank">
            <div class="file-block__file file-list__type">
                @@include('../components/svg/file.html')
                <div class="file-block__type">pdf</div>
            </div>

            <div class="file-block__content">
                <div class="file-block__title file-list__title">Заголовок (H4) Название документа. Размер может быть любой количество символ и строк не ограничено. Название документа. Размер может быть любой количество символ и строк не ограничено.</div>

                <div class="file-block__size">
                    32,5 kB
                    <div class="file-block__download">@@include('../components/svg/download.html')</div>
                </div>
            </div>
        </a>
        
        <a href="#" class="file-block file-list__file" target="_blank">
            <div class="file-block__file file-list__type">
                @@include('../components/svg/file.html')
                <div class="file-block__type">pdf</div>
            </div>

            <div class="file-block__content">
                <div class="file-block__title file-list__title">Заголовок (H4) Название документа. Размер может быть любой количество символ и строк не ограничено. </div>

                <div class="file-block__size">
                    32,5 kB
                    <div class="file-block__download">@@include('../components/svg/download.html')</div>
                </div>
            </div>
        </a>
        
        <a href="#" class="file-block file-list__file" target="_blank">
            <div class="file-block__file file-list__type">
                @@include('../components/svg/file.html')
                <div class="file-block__type">pdf</div>
            </div>

            <div class="file-block__content">
                <div class="file-block__title file-list__title">Заголовок (H4) Название документа. Размер может быть любой количество символ и строк не ограничено. Название документа. Размер может быть любой количество символ и строк не ограничено. Название документа. Размер может быть любой количество символ и строк не ограничено. Название документа. Размер может быть любой количество символ и строк не ограничено.</div>

                <div class="file-block__size">
                    32,5 kB
                    <div class="file-block__download">@@include('../components/svg/download.html')</div>
                </div>
            </div>
        </a>
        
        <a href="#" class="file-block file-list__file" target="_blank">
            <div class="file-block__file file-list__type">
                @@include('../components/svg/file.html')
                <div class="file-block__type">pdf</div>
            </div>

            <div class="file-block__content">
                <div class="file-block__title file-list__title">Заголовок (H4) Название документа. Размер может быть любой количество символ и строк не ограничено. Название документа. Размер может быть любой количество символ и строк не ограничено.</div>

                <div class="file-block__size">
                    32,5 kB
                    <div class="file-block__download">@@include('../components/svg/download.html')</div>
                </div>
            </div>
        </a>
    </div>
    
    <div class="accordion-wrapper" data-tabs="fastening-schemes" style="display: none;">
        <div class="accordion accordion_small">
            <div class="accordion__header">
                <h4 class="accordion__title">Заголовок (H4) Название группы документов. Размер может быть любой количество символ и строк не ограничено.</h4>

                <div class="accordion__btn">
                    @@include('../components/svg/daw-bold.html')
                </div>
            </div>
            
            <div class="accordion__container">
                <div class="accordion__wrapper">
                    ...
                </div>
            </div>
        </div>
        
        <div class="accordion accordion_small">
            <div class="accordion__header">
                <h4 class="accordion__title">Заголовок (H4) Название группы документов. Размер может быть любой количество символ и строк не ограничено.</h4>

                <div class="accordion__btn">
                    @@include('../components/svg/daw-bold.html')
                </div>
            </div>
            
            <div class="accordion__container">
                <div class="accordion__wrapper">
                    ...
                </div>
            </div>
        </div>
        
        <div class="accordion accordion_small">
            <div class="accordion__header">
                <h4 class="accordion__title">Заголовок (H4) Название группы документов. Размер может быть любой количество символ и строк не ограничено.</h4>

                <div class="accordion__btn">
                    @@include('../components/svg/daw-bold.html')
                </div>
            </div>

            <div class="accordion__container">
                <div class="accordion__wrapper">
                    ...
                </div>
            </div>
        </div>
    </div>
</div>

<script id="permission-template" type="text/template">
    <div class="dangerous-goods-permission__content">
        <div class="dangerous-goods-permission__col">
            <div class="subtitle">Название</div>
            <h3 class="dangerous-goods-permission__title">Ксантогенаты xanthates</h3>
            <div class="dangerous-goods-permission__description">Желтый гигроскопический порошок с неприятным запахом. при контакте с влагой выделяет такие жирные кислоты</div>
            <div class="subtitle">Прием в порт</div>
            <div class="dangerous-goods-permission__depiction">Желтый гигроскопический порошок с неприятным запахом. при контакте с влагой выделяет такие жирные кислоты</div>
        </div>
        <div class="dangerous-goods-permission__col">
            <div class="subtitle">Номер ООН</div>
            <div class="dangerous-goods-permission__value">3342</div>

            <div class="subtitle">Группа упаковки</div>
            <div class="dangerous-goods-permission__value">I - вещества с высокой степенью опасности</div>

            <div class="subtitle">Класс или подкласс</div>
            <div class="dangerous-goods-permission__value">4.2</div>

            <div class="dangerous-goods-permission__additional-wrapper">
                <div class="dangerous-goods-permission__additional">
                    <div class="subtitle">Доп виды опасности</div>
                    Информация отсутствует
                </div>
                <div class="dangerous-goods-permission__additional">
                    <div class="subtitle">Запрещен прием по&nbsp;ЖД</div>
                    Информация отсутствует
                </div>
                <div class="dangerous-goods-permission__additional">
                    <div class="subtitle">Инструкции по&nbsp;цистернам</div>
                    ТЗ
                </div>
            </div>
        </div>
    </div>
    <div class="dangerous-goods-permission__status dangerous-goods-permission__status_success">Согласован</div>
    <div class="dangerous-goods-permission__depiction">*Для дополнительного согласования необходимо обратиться к вашему экспедитору</div>
</script>

<script defer>
    const form = document.querySelector('#permission-form');
    const tableWrapper = document.querySelector('.dangerous-goods__table');
    const tablePermissionsHtml = document.querySelector('#table-permission-body');
    const permissionsHtml = document.querySelector('.dangerous-goods__permissions');
    const permissionsTemplate = document.querySelector('#permission-template').innerHTML;
    const tablePermissions = [];
    const permissions = [];
    
    function initTablePermissions() {
        const idxCells = [...tablePermissionsHtml.querySelectorAll('[data-idx]')];
        
        if (!idxCells.length) {
            tableWrapper.style.display = 'none';
        }
        else {
            idxCells.forEach((cell, idx) => cell.innerHTML = idx + 1);
            
            tableWrapper.style.display = '';
        }
    }

    function addTablePermission(permission) {
        tablePermissions.push(permission);
        
        const { ooh, group } = permission;

        const row = document.createElement('tr');
        
        row.innerHTML = `
            <td data-idx></td>
            <td>${ooh}</td>
            <td>${selects['permission-form_group'].getItem(group).text}</td>
            <td class="dangerous-goods__cross-wrapper"><div class="dangerous-goods__cross">@@include('../components/svg/cross.html')</div></td>`;
        
        tablePermissionsHtml.append(row);

        initTablePermissions();
    }

    form.addEventListener('submit', event => {
        event.preventDefault();

        const permission = formValidate(form, {
            ooh: {
                type: 'input',
                validate: 'required'
            },
            group: {
                type: 'select',
                validate: 'required'
            }
        }, false);

        if (permission) {
            addTablePermission(permission);
        }
    });

    tablePermissionsHtml.addEventListener('click', ({ target }) => {
        const row = target.closest('.dangerous-goods__cross-wrapper');
        
        if (row) {
            const parent = row.parentNode;
            parent.remove();
            tablePermissions.splice(+parent.querySelector('[data-idx]').innerHTML - 1, 1);
            
            initTablePermissions();
        }
    });
    
    function requestPermission() {
        permissions.length = 0;
        permissions.push(...tablePermissions);
        
        if (tablePermissions.length) {
            permissionsHtml.innerHTML = permissionsHtml.style.display = '';

            tablePermissions.forEach(({}) => {
                const newPermission = document.createElement('div');
                newPermission.innerHTML = permissionsTemplate;
                newPermission.classList.add('dangerous-goods-permission');
                
                
                permissionsHtml.append(newPermission);
            });
        }
        else {
            permissionsHtml.style.display = 'none';
        }
    }
</script>